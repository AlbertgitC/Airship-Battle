!function(s){var e={};function t(i){if(e[i])return e[i].exports;var h=e[i]={i:i,l:!1,exports:{}};return s[i].call(h.exports,h,h.exports,t),h.l=!0,h.exports}t.m=s,t.c=e,t.d=function(s,e,i){t.o(s,e)||Object.defineProperty(s,e,{enumerable:!0,get:i})},t.r=function(s){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},t.t=function(s,e){if(1&e&&(s=t(s)),8&e)return s;if(4&e&&"object"==typeof s&&s&&s.__esModule)return s;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:s}),2&e&&"string"!=typeof s)for(var h in s)t.d(i,h,function(e){return s[e]}.bind(null,h));return i},t.n=function(s){var e=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(e,"a",e),e},t.o=function(s,e){return Object.prototype.hasOwnProperty.call(s,e)},t.p="",t(t.s=0)}([function(s,e,t){"use strict";t.r(e);var i=class{constructor(s,e){this.ctx=e,this.game=s,this.ships=s.addShips()}checkBombHit(){if(this.game.bomb.length>0){let s;s="ship1"===this.game.selected_ship.name?this.ships[1]:this.ships[0];const e=this.game.selected_ship.bomb.center_pos,t=s.center_pos;return Math.pow(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2),.5)<=55?(this.game.remove(this.game.selected_ship.bomb),this.game.addExplosion(this.game.selected_ship.bomb),this.game.selected_ship.bomb=null,"ship1"===this.game.selected_ship.name?(this.ships[1].hp--,0===this.ships[1].hp&&(this.game.addExplosion(this.ships[1]),document.getElementById("game-over-menu").firstElementChild.innerHTML="Player 1 Won!",document.getElementById("game-over-menu").style.display="flex",key.unbind("w, a, s, d, q, e, g, space"))):"ship2"===this.game.selected_ship.name&&(this.ships[0].hp--,0===this.ships[0].hp&&(this.game.addExplosion(this.ships[0]),document.getElementById("game-over-menu").firstElementChild.innerHTML="Player 2 Won!",document.getElementById("game-over-menu").style.display="flex",key.unbind("w, a, s, d, q, e, g, space"))),!0):(this.game.rocks.forEach(s=>{const t=s.pos;if(Math.pow(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2),.5)<=5+s.radius)return s.removable&&(this.game.remove(s),this.game.addExplosion(s)),this.game.remove(this.game.selected_ship.bomb),this.game.addExplosion(this.game.selected_ship.bomb),this.game.selected_ship.bomb=null,!0}),!1)}return!1}start(){this.cloud=this.game.addBackground(),this.lastTime=0,requestAnimationFrame(this.animate.bind(this))}animate(s){this.game.draw(this.ctx),this.cloud.move(),this.checkBombHit(),this.lastTime=s,requestAnimationFrame(this.animate.bind(this))}};var h=class{constructor(s){this.curFrameCount=0,this.spriteFrameCount=2,this.curFrame=0,this.sprite_x_start=0,this.sprite_y_start=0,this.bomb_image=new Image,this.bomb_image.src="./src/assets/torpedo.png",this.pos=s.pos,this.game=s.game,this.ship=s.ship,this.bomb_path=s.bomb_path,this.step=0,this.center_pos=[this.pos[0],this.pos[1]]}draw(s){this.curFrameCount++;let e,t;if(this.curFrameCount>1&&(this.curFrame=++this.curFrame%this.spriteFrameCount,this.curFrameCount=0),e=30*this.curFrame+this.sprite_x_start,t="right"===this.ship.facing?this.sprite_y_start+31:this.sprite_y_start,this.bomb_path[this.step])for(let e=0;e<=this.step;e++)s.moveTo(this.bomb_path[e][0],this.bomb_path[e][1]),s.beginPath(),s.fillStyle="brown",s.arc(this.bomb_path[e][0],this.bomb_path[e][1],1,0,2*Math.PI),s.fill();else this.bomb_path.forEach(e=>{s.moveTo(e[0],e[1]),s.beginPath(),s.fillStyle="brown",s.arc(e[0],e[1],1,0,2*Math.PI),s.fill()});s.drawImage(this.bomb_image,e,t,30,30,this.pos[0]-19,this.pos[1]-17,40,40),this.move()}move(){this.bomb_path[this.step]&&!this.game.exitingVerBounds(this.bomb_path[this.step])?(this.pos=this.bomb_path[this.step],this.center_pos=[this.pos[0]+10,this.pos[1]+10],this.step++):this.game.exitingVerBounds(this.bomb_path[this.step])&&(this.game.remove(this),this.ship.bomb=null)}drawHitBox(s){s.lineWidth=1,s.strokeStyle="black",s.beginPath(),s.arc(this.pos[0],this.pos[1],8,0,2*Math.PI),s.stroke()}};var r=class{constructor(s){this.name=s.name,this.pos=s.pos,this.curFrameCount=0,this.spriteFrameCount=8,this.curFrame=0,this.game=s.game,this.sprite_x_start=s.sprite_x_start,this.sprite_y_start=s.sprite_y_start,this.ship_image=new Image,this.ship_image.src="./src/assets/zeplin.png",this.aim_angle=0,this.aim_mode=!1,this.facing=s.facing,this.bomb_path=null,this.center_pos=[this.pos[0]+50,this.pos[1]+50],this.selected=s.selected,this.energy=100,this.hp=3,this.fired=!1}draw(s){this.curFrameCount++;let e,t;this.curFrameCount>8&&(this.curFrame=++this.curFrame%this.spriteFrameCount,this.curFrameCount=0),e=120*this.curFrame+this.sprite_x_start,this.aim_mode&&this.drawAim(s),!this.bomb&&this.bomb_path&&this.selected&&this.drawPath(s),t="left"===this.facing?this.sprite_y_start+121:this.sprite_y_start,s.drawImage(this.ship_image,e,t,120,120,this.pos[0]-17,this.pos[1]-19,140,140)}drawAim(s){if("right"===this.facing){s.beginPath(),s.lineWidth=2,s.strokeStyle="orange";const e=100*Math.sin(this.aim_angle*Math.PI/180),t=Math.sqrt(1e4-Math.pow(e,2));s.moveTo(this.center_pos[0],this.center_pos[1]),s.lineTo(this.pos[0]+50+t,this.pos[1]+50-e),s.stroke()}else if("left"===this.facing){s.beginPath(),s.lineWidth=2,s.strokeStyle="orange";const e=100*Math.sin(this.aim_angle*Math.PI/180),t=Math.sqrt(1e4-Math.pow(e,2));s.moveTo(this.center_pos[0],this.center_pos[1]),s.lineTo(this.pos[0]+50-t,this.pos[1]+50-e),s.stroke()}}aim(s){if(s>0&&this.aim_angle<60){const e=this.aim_angle+s;this.aim_angle=e}else if(s<0&&this.aim_angle>-60){const e=this.aim_angle+s;this.aim_angle=e}}drawPath(s){this.bomb_path.forEach(e=>{s.beginPath(),s.moveTo(e[0],e[1]),s.fillStyle="brown",s.arc(e[0],e[1],1,0,2*Math.PI),s.fill()})}drawHitBox(s){s.lineWidth=1,s.strokeStyle="black",s.beginPath(),s.arc(this.center_pos[0],this.center_pos[1],50,0,2*Math.PI),s.stroke()}fire(){if(!this.fired){this.fired=!0,key.unbind("w, a, s, d, q, e, g, space"),this.bomb_path=[];let s,e,t=0;const i=this.aim_angle/180*Math.PI/40;if("right"===this.facing)for(let h=0;h<=2160;h+=5)s=this.pos[0]+50+h,e=this.pos[1]+50-290*Math.sin(t),t+=i,this.bomb_path.push([s,e]);else for(let h=0;h<=2160;h+=5)s=this.pos[0]+50-h,e=this.pos[1]+50-290*Math.sin(t),t+=i,this.bomb_path.push([s,e]);this.bomb=new h({pos:this.bomb_path[0],game:this.game,ship:this,bomb_path:this.bomb_path}),this.game.addBomb(this.bomb)}}move(s){this.pos=[this.pos[0]+s[0],this.pos[1]+s[1]],this.center_pos=[this.pos[0]+50,this.pos[1]+50],this.game.exitingBounds(this.center_pos)&&(this.center_pos[0]<0?this.pos=[this.pos[0]+4,this.pos[1]]:this.center_pos[1]<0?this.pos=[this.pos[0],this.pos[1]+4]:this.center_pos[0]>1870?this.pos=[this.pos[0]-4,this.pos[1]]:this.center_pos[1]>720&&(this.pos=[this.pos[0],this.pos[1]-4]));const e=this.center_pos;this.game.rocks.forEach(s=>{const t=s.pos;Math.pow(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2),.5)<=50+s.radius&&(this.center_pos[0]<t[0]&&this.center_pos[1]<=t[1]?this.pos=[this.pos[0],this.pos[1]-4]:this.center_pos[0]>=t[0]&&this.center_pos[1]<t[1]?this.pos=[this.pos[0],this.pos[1]-4]:this.center_pos[0]>t[0]&&this.center_pos[1]>=t[1]?this.pos=[this.pos[0],this.pos[1]+4]:this.center_pos[0]<=t[0]&&this.center_pos[1]>t[1]&&(this.pos=[this.pos[0],this.pos[1]+4]))})}spendEnergy(){this.energy<=0?(key.unbind("w, a, s, d"),key("a",()=>{this.facing="left"}),key("d",()=>{this.facing="right"})):this.energy--}};var a=class{constructor(s){this.pos=s.pos,this.game=s.game,this.x_vel=s.x_vel,this.cloud_img=new Image,this.cloud_img.src="./src/assets/background/clouds.png"}move(){this.pos=[this.pos[0]-1,this.pos[1]],this.game.exitedBounds(this.pos,1870,510)&&(this.pos=[0,210])}draw(s){s.drawImage(this.cloud_img,0,0,544,236,this.pos[0],this.pos[1],935,510),s.drawImage(this.cloud_img,0,0,544,236,this.pos[0]+935,this.pos[1],935,510),s.drawImage(this.cloud_img,0,0,544,236,this.pos[0]+1870,this.pos[1],935,510),s.drawImage(this.cloud_img,0,0,544,236,this.pos[0]+2805,this.pos[1],935,510)}};var o=class{constructor(s){this.curFrameCount=0,this.spriteFrameCount=1,this.curFrame=0,this.sprite_x_start=s.sprite_x_start,this.sprite_y_start=0,this.rock_image=new Image,this.rock_image.src="./src/assets/rocks.png",this.pos=s.pos,this.game=s.game,this.radius=s.radius,this.resize=s.resize,this.removable=s.removable}draw(s){this.curFrameCount++;let e;e=120*this.curFrame+this.sprite_x_start,s.drawImage(this.rock_image,e,this.sprite_y_start,120,120,this.pos[0]-this.resize[0]/2,this.pos[1]-this.resize[1]/2,this.resize[0],this.resize[1])}drawHitBox(s){s.lineWidth=1,s.strokeStyle="black",s.beginPath(),s.arc(this.pos[0],this.pos[1],this.radius,0,2*Math.PI),s.stroke()}};var n=class{constructor(s){this.curFrameCount=0,this.spriteFrameCount=8,this.curFrame=0,this.sprite_x_start=0,this.sprite_y_start=0,this.explode_image=new Image,this.pos=s.pos,this.game=s.game,this.object=s.object}draw(s){let e,t,i,a;this.curFrameCount++,this.object instanceof h?(e=50,t=50,i=[50,50],this.explode_image.src="./src/assets/explode1.png"):this.object instanceof o?(e=120,t=120,i=[230,230],this.explode_image.src="./src/assets/rock_down.png"):this.object instanceof r&&(e=64,t=64,i=[150,150],this.explode_image.src="./src/assets/explode2.png"),this.curFrameCount>8&&(this.curFrame=++this.curFrame%this.spriteFrameCount,this.curFrameCount=0),a=this.curFrame*e+this.sprite_x_start,this.object instanceof r||this.curFrame!==this.spriteFrameCount-1||this.game.remove(this),s.drawImage(this.explode_image,a,this.sprite_y_start,e,t,this.pos[0]-i[0]/2,this.pos[1]-i[1]/2,i[0],i[1])}};var p=class{constructor(){this.ships=[],this.bomb=[],this.rocks=[],this.explosion=[],this.curFrameCount=0,this.curFrame=0,this.hp_bar_image=new Image,this.hp_bar_image.src="./src/assets/hp_bar2.png",this.current_ship_image=new Image,this.current_ship_image.src="./src/assets/current_player.png",this.selected_ship}add(s){if(s instanceof r)this.ships.push(s);else if(s instanceof h)this.bomb.push(s);else if(s instanceof o)this.rocks.push(s);else{if(!(s instanceof n))throw new Error("unknown type of object");this.explosion.push(s)}}allObjects(){return[].concat(this.rocks,this.ships,this.bomb,this.explosion)}addShips(){const s=new r({name:"ship1",pos:[100,360],game:this,sprite_x_start:0,sprite_y_start:0,facing:"right",selected:!0}),e=new r({name:"ship2",pos:[1670,360],game:this,sprite_x_start:0,sprite_y_start:241,facing:"left",selected:!1});return this.add(s),this.add(e),this.selected_ship=this.ships[0],[s,e]}addBomb(s){this.add(s)}addRocks(){const s=new o({sprite_x_start:0,pos:[935,400],game:this,radius:135,resize:[400,400],removable:!1}),e=new o({sprite_x_start:121,pos:[320,300],game:this,radius:46,resize:[230,230],removable:!0}),t=new o({sprite_x_start:121,pos:[1550,300],game:this,radius:46,resize:[230,230],removable:!0}),i=new o({sprite_x_start:241,pos:[510,620],game:this,radius:37,resize:[230,230],removable:!0}),h=new o({sprite_x_start:241,pos:[680,140],game:this,radius:37,resize:[230,230],removable:!0}),r=new o({sprite_x_start:241,pos:[1190,140],game:this,radius:37,resize:[230,230],removable:!0}),a=new o({sprite_x_start:241,pos:[1360,620],game:this,radius:37,resize:[230,230],removable:!0});this.add(s),this.add(e),this.add(t),this.add(i),this.add(h),this.add(r),this.add(a)}addExplosion(s){const e=new n({pos:s.center_pos||s.pos,game:this,object:s});this.add(e)}addBackground(){return this.sky=new Image,this.sky.src="./src/assets/background/sky.png",this.addRocks(),this.cloud=new a({pos:[0,210],x_vel:1,game:this}),this.cloud}draw(s){s.clearRect(0,0,1870,720),s.drawImage(this.sky,0,0,112,304,0,0,1870,720),this.cloud.draw(s),this.allObjects().forEach(e=>{e.draw(s)}),this.drawStatus(s),this.drawSelector(s)}exitingBounds(s){return s[0]<0||s[1]<0||s[0]>1870||s[1]>720}exitingVerBounds(s){return s[0]<0||s[0]>1870}exitedBounds(s,e,t){return s[0]<-e||s[1]<-t||s[0]>1870||s[1]>720}wrap(s){let e;return e=s[0]<0?1870-s[0]%1870:s[0]>1870?s[0]%1870:s[0],[e,s[1]]}remove(s){if(s instanceof h)this.bomb.splice(this.bomb.indexOf(s),1),this.bindKeyHandlers();else if(s instanceof n)this.explosion.splice(this.explosion.indexOf(s),1);else{if(!(s instanceof o))throw new Error("unknown type of object");this.rocks.splice(this.rocks.indexOf(s),1)}}drawStatus(s){this.ships.forEach(e=>{let t,i;3===e.hp?t=0:2===e.hp?t=101:1===e.hp?t=201:0===e.hp&&(t=301),100===e.energy?i=0:e.energy<100&&e.energy>=95?i=101:e.energy<95&&e.energy>=85?i=201:e.energy<85&&e.energy>=75?i=301:e.energy<75&&e.energy>=65?i=401:e.energy<65&&e.energy>=55?i=501:e.energy<55&&e.energy>=45?i=601:e.energy<45&&e.energy>=35?i=701:e.energy<35&&e.energy>=25?i=801:e.energy<25&&e.energy>=15?i=901:e.energy<15&&e.energy>=5?i=1001:e.energy<5&&e.energy>0?i=1101:0===e.energy&&(i=1201),s.drawImage(this.hp_bar_image,t,i,100,100,e.pos[0]-20,e.pos[1]-100,150,150)})}drawSelector(s){this.curFrameCount++;let e;this.curFrameCount>5&&(this.curFrame=++this.curFrame%4,this.curFrameCount=0),e=40*this.curFrame,this.ships.forEach(t=>{t.selected&&("ship1"===t.name?s.drawImage(this.current_ship_image,e,0,40,40,t.pos[0]+30,t.pos[1]-110,50,50):"ship2"===t.name&&s.drawImage(this.current_ship_image,e,41,40,40,t.pos[0]+30,t.pos[1]-110,50,50))})}moveMode(){key("w",()=>{this.selected_ship.move([0,-4]),this.selected_ship.spendEnergy(),this.selected_ship.aim_mode=!1,this.selected_ship.aim_angle=0}),key("a",()=>{this.selected_ship.move([-4,0]),this.selected_ship.facing="left",this.selected_ship.spendEnergy(),this.selected_ship.aim_mode=!1,this.selected_ship.aim_angle=0}),key("s",()=>{this.selected_ship.move([0,4]),this.selected_ship.spendEnergy(),this.selected_ship.aim_mode=!1,this.selected_ship.aim_angle=0}),key("d",()=>{this.selected_ship.move([4,0]),this.selected_ship.facing="right",this.selected_ship.spendEnergy(),this.selected_ship.aim_mode=!1,this.selected_ship.aim_angle=0})}aimMode(){key("q",()=>{this.selected_ship.aim(2),this.selected_ship.aim_mode=!0}),key("e",()=>{this.selected_ship.aim(-2),this.selected_ship.aim_mode=!0})}bindKeyHandlers(){this.moveMode(),this.aimMode(),key("g",()=>{key.unbind("w, a, s, d"),"ship1"===this.selected_ship.name?(this.selected_ship=this.ships[1],this.selected_ship.selected=!0,this.selected_ship.fired=!1,this.selected_ship.energy=100,this.ships[0].selected=!1,this.ships[0].aim_mode=!1,this.selected_ship.aim_mode=!1,this.selected_ship.aim_angle=0,this.moveMode()):"ship2"===this.selected_ship.name&&(this.selected_ship=this.ships[0],this.selected_ship.selected=!0,this.selected_ship.fired=!1,this.selected_ship.energy=100,this.ships[1].selected=!1,this.ships[1].aim_mode=!1,this.selected_ship.aim_mode=!1,this.selected_ship.aim_angle=0,this.moveMode())}),key("space",()=>{this.selected_ship.fire()})}};const m=s=>{const e=new p;new i(e,s).start(),e.bindKeyHandlers()},c=()=>{const s=parseInt(window.innerWidth/1900*100);document.body.style.zoom=`${s}%`};document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("game-canvas").getContext("2d");(s=>{const e=new p;new i(e,s).start()})(s),c(),document.getElementById("start").onclick=()=>{m(s),document.getElementById("start-menu").style.display="none"},document.getElementById("restart").onclick=()=>{m(s),document.getElementById("game-over-menu").style.display="none"},window.addEventListener("resize",c)})}]);